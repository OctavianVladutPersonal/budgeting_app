<!DOCTYPE html>
<html>
<head>
    <title>Expense Tracker</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 400px; margin: auto; background: #f4f4f9; }
        form { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        label { display: block; margin-top: 10px; font-weight: bold; }
        input, select, textarea { width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        button { width: 100%; margin-top: 20px; padding: 10px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #218838; }
    </style>
</head>
<body>

    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2 style="margin: 0;">Add Transaction</h2>
        <button type="button" onclick="openSpreadsheet()" style="width: auto; padding: 10px 20px;">ðŸ“Š View Spreadsheet</button>
    </div>
    <form id="trackerForm">
        <label>Date</label>
        <input type="date" id="date" required>

        <label>Day of the Week</label>
        <input type="text" id="dayOfWeek" readonly style="background: #eee;">

        <label>Type</label>
        <select id="type">
            <option value="Expense" selected>Expense</option>
            <option value="Income">Income</option>
        </select>

        <label>Amount *</label>
        <input type="number" id="amount" step="0.01" required>

        <label>Category</label>
        <select id="category">
            <option>Housing</option><option>Utilities</option><option>Transportation</option>
            <option>Groceries</option><option>Going out</option><option>Insurance</option>
            <option>Healthcare</option><option>Personal Care</option><option>Entertainment</option>
            <option>Vacation</option><option>Education</option><option>Debt</option>
            <option>Savings & Investments</option><option>Childcare & School</option><option>Others</option>
        </select>

        <label>Account Used</label>
        <select id="account">
            <option>Ale</option>
            <option>Tavi</option>
        </select>

        <label>Notes</label>
        <textarea id="notes" rows="3"></textarea>

        <button type="submit" id="submitBtn">Send to Sheet</button>
    </form>

    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbww0NyPm_ufA_iOUKJ0JbGnvyuVxwbnYKSJfAvow3Fnt1_U7UJtu9_fCezYS33Pn-cq7w/exec';
        const SPREADSHEET_URL = 'https://docs.google.com/spreadsheets/d/1oqS9MSo3XVw95jNPX-Lz0um-ookdlbM4uWzDtWyL3bU/edit';
        
        // Function to open the spreadsheet
        function openSpreadsheet() {
            window.open(SPREADSHEET_URL, '_blank');
        }

        const dateInput = document.getElementById('date');
        const dayInput = document.getElementById('dayOfWeek');

        // Set default date to today
        const today = new Date().toISOString().split('T')[0];
        dateInput.value = today;

        // Function to update Day of Week
        function updateDay() {
            const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            const d = new Date(dateInput.value);
            dayInput.value = days[d.getDay()];
        }
        
        updateDay(); // Run on load
        dateInput.addEventListener('change', updateDay);

        // Handle Form Submission
        document.getElementById('trackerForm').addEventListener('submit', e => {
            e.preventDefault();
            const btn = document.getElementById('submitBtn');
            btn.disabled = true;
            btn.innerText = "Sending...";

            const payload = {
                date: dateInput.value,
                dayOfWeek: dayInput.value,
                type: document.getElementById('type').value,
                amount: document.getElementById('amount').value,
                category: document.getElementById('category').value,
                account: document.getElementById('account').value,
                notes: document.getElementById('notes').value
            };

            fetch(scriptURL, {
                method: 'POST',
                mode: 'no-cors',
                body: JSON.stringify(payload)
            })
            .then(() => {
                alert("Success!");
                document.getElementById('trackerForm').reset();
                dateInput.value = today;
                updateDay();
                btn.disabled = false;
                btn.innerText = "Send to Sheet";
            })
            .catch(error => console.error('Error!', error.message));
        });
    </script>
</body>
</html>